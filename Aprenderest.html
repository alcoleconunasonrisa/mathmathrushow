<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aprendresta - Operaci√≥n Final</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --grass: #9cdb43;
            --sky: #87ceeb;
            --apple: #ff4d4d;
            --basket: #8b4513;
            --error: #e74c3c;
            --success: #2ecc71;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background: var(--sky);
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            height: 100vh;
            overflow: hidden;
            color: #2c3e50;
        }

        .header {
            background: white;
            padding: 10px 20px;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            width: fit-content;
            margin-bottom: 5px;
        }

        .target-text { font-weight: bold; font-size: 0.9rem; }
        .target-number {
            font-size: 2.5rem;
            color: var(--apple);
            font-weight: 900;
            line-height: 1;
        }

        .basket-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-grow: 1;
            justify-content: center;
        }

        .basket {
            width: 180px;
            height: 120px;
            background: var(--basket);
            border-radius: 10px 10px 70px 70px;
            border: 5px solid #5d2e0a;
            display: flex;
            flex-wrap: wrap;
            padding: 10px;
            gap: 4px;
            justify-content: center;
            align-content: flex-end;
        }

        .apple {
            width: 28px;
            height: 28px;
            background: var(--apple);
            border-radius: 50%;
            position: relative;
            cursor: pointer;
            box-shadow: inset -3px -3px 0 rgba(0,0,0,0.1);
            transition: transform 0.1s;
        }

        .apple:active { transform: scale(0.9); }

        .apple::before {
            content: '';
            position: absolute;
            top: -4px;
            left: 11px;
            width: 3px;
            height: 6px;
            background: #4a2c00;
        }

        .counter {
            font-size: 2rem;
            font-weight: 900;
            margin: 5px 0;
            color: #5d2e0a;
        }

        .controls { margin-bottom: 10px; }

        #check-btn {
            background: #2c3e50;
            color: white;
            border: none;
            padding: 10px 30px;
            font-size: 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 0 #1a252f;
        }

        #feedback-msg {
            margin-top: 8px;
            padding: 5px 15px;
            border-radius: 8px;
            font-weight: bold;
            display: none;
            font-size: 0.9rem;
        }

        .ground-area {
            background: var(--grass);
            width: 100%;
            height: 22%;
            border-top: 5px solid #86c038;
            padding: 10px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            overflow-y: auto;
        }

        /* Ventana de √©xito */
        .modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 80%;
            box-shadow: 0 0 20px var(--success);
        }

        .operation-display {
            font-size: 3.5rem;
            font-weight: 900;
            color: #2c3e50;
            margin: 20px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px dashed #bdc3c7;
        }
        
.btn-home {
    display: inline-block;
    padding: 10px 20px;
    background-color: white;
    color: #2c3e50;
    text-decoration: none;
    border-radius: 15px;
    font-weight: bold;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    transition: transform 0.2s;
}

.btn-home:hover {
    transform: scale(1.1);
    background-color: #f0f0f0;
}
    </style>
</head>
<body>
<div style="position: absolute; top: 10px; left: 10px;">
    <a href="main-index.html" class="btn-home">üè† Inicio</a>
</div>
    <div class="header">
        <div class="target-text">DEJA EN LA CESTA:</div>
        <span class="target-number" id="targetNum">0</span>
    </div>

    <div class="basket-container">
        <div class="basket" id="basket"></div>
        <div class="counter" id="basketCount">0</div>
    </div>

    <div class="controls">
        <button id="check-btn" onclick="verify()">¬°LISTO!</button>
        <div id="feedback-msg"></div>
    </div>

    <div class="ground-area" id="ground"></div>

    <div class="modal" id="winModal">
        <div class="modal-content">
            <h2 style="color: var(--success); margin: 0;">¬°LO HAS HECHO GENIAL! üåü</h2>
            <div class="operation-display" id="opResult">0 - 0 = 0</div>
            <p id="textExplanation" style="font-weight: bold; color: #7f8c8d;"></p>
            <button onclick="initGame()" style="background: var(--success); color: white; border: none; padding: 12px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 1.2rem;">SIGUIENTE RETO</button>
        </div>
    </div>

<script>
    let target = 0;
    let totalInitial = 0;
    const basket = document.getElementById('basket');
    const ground = document.getElementById('ground');
    const feedback = document.getElementById('feedback-msg');

    function initGame() {
        document.getElementById('winModal').style.display = 'none';
        feedback.style.display = 'none';
        basket.innerHTML = '';
        ground.innerHTML = '';

        // Definimos n√∫meros aleatorios
        target = Math.floor(Math.random() * 6) + 2; // Quedan entre 2 y 7
        totalInitial = target + Math.floor(Math.random() * 5) + 2; // Empezamos con extras
        
        document.getElementById('targetNum').innerText = target;

        // Llenamos la cesta
        for(let i=0; i < totalInitial; i++) {
            const apple = document.createElement('div');
            apple.className = 'apple';
            apple.onclick = () => moveApple(apple);
            basket.appendChild(apple);
        }
        updateUI();
    }

    function moveApple(apple) {
        feedback.style.display = 'none';
        if (apple.parentElement === basket) {
            ground.appendChild(apple);
        } else {
            basket.appendChild(apple);
        }
        updateUI();
    }

    function updateUI() {
        document.getElementById('basketCount').innerText = basket.children.length;
    }

    function verify() {
        const current = basket.children.length;
        const removed = totalInitial - current;
        feedback.style.display = 'block';

        if (current === target) {
            // Mostrar la operaci√≥n matem√°tica
            document.getElementById('opResult').innerText = `${totalInitial} - ${removed} = ${target}`;
            document.getElementById('textExplanation').innerText = `Hab√≠a ${totalInitial}, has quitado ${removed} y ahora quedan ${target}.`;
            document.getElementById('winModal').style.display = 'flex';
        } else {
            feedback.style.background = 'var(--error)';
            feedback.style.color = 'white';
            if (current > target) {
                feedback.innerText = `¬°A√∫n sobran! Tienes que quitar ${current - target} m√°s.`;
            } else {
                feedback.innerText = `¬°Has quitado demasiadas! Devuelve ${target - current} a la cesta.`;
            }
        }
    }

    window.onload = initGame;
</script>
</body>
</html>
